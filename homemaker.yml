tasks:
  default:
    deps:
      - bash
      - git
      - gpg
      - vim
      - power_management
      - browsers
    cmds:
      - ["mkdir", "-p", "$HM_DEST/code"]

  power_management:
    cmds:
      - ["@install", "powertop", "tlp", "tlp-rdw"]

  browsers:
    cmds:
      - ["@install", "chromium", "firefox-esr"]

  config_variables:
    envs:
      - ["NAME", "Renaud Martinet"]
      - ["EMAIL", "me@renaudmarti.net"]

  bash:
    deps:
      - bash_install
      - bash_config

  bash_install:
    rejects:
      - ["which", "bash"]
    cmds:
      - ["@install", "bash"]
      - ["chsh", "-s", "/bin/bash"]

  bash_config:
    linksl:
      - [".bashrc_logout", "bash/bashrc_logout.symlink"]
      - [".bashrc", "bash/bashrc.symlink"]
      - [".profile", "bash/profile.symlink"]

  git:
    deps:
      - config_variables
    cmds:
      - ["@install", "git"]
    templates:
      - ["git/gitconfig.symlink.generated", "git/gitconfig.symlink.template"]
    links:
      - [".gitconfig", "git/gitconfig.symlink.generated"]
      - [".gitignore", "git/gitignore.symlink"]

  gpg:
    cmds:
      - ["@install", "gnupg2"]
    links:
      - [".gnupg", "gnupg.symlink"]

  vim:
    cmds:
      - ["@install", "vim"]
    links:
      - [".vimrc", "vimrc.symlink"]

macros:
  install:
    prefix: ["sudo", "apt", "install", "-yqq"]
